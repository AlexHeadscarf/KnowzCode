{
  "name": "validate-installation",
  "version": "2.0.0",
  "description": "Validates that KnowzCode installation completed successfully with required directories and files",

  "parameters": [],

  "actions": [
    {
      "type": "python",
      "code": "from pathlib import Path\nimport json\n\n# Check for knowzcode directory (the primary installation target)\nknowzcode_dir = Path('knowzcode')\nerrors = []\nwarnings = []\n\n# Check directory exists\nif not knowzcode_dir.exists():\n    errors.append('knowzcode/ directory not found')\n    outputs['valid'] = False\n    outputs['errors'] = errors\n    outputs['warnings'] = warnings\n    outputs['commands_count'] = 0\n    outputs['skills_count'] = 0\n    outputs['agents_count'] = 0\n    exit()\n\n# Check required knowzcode files\nrequired_files = [\n    'knowzcode_loop.md',\n    'knowzcode_tracker.md',\n    'knowzcode_project.md',\n    'knowzcode_architecture.md'\n]\n\nfor required_file in required_files:\n    if not (knowzcode_dir / required_file).exists():\n        errors.append(f'Missing required file: knowzcode/{required_file}')\n\n# Check required subdirectories\nrequired_dirs = [\n    'specs',\n    'workgroups',\n    'prompts'\n]\n\nfor subdir in required_dirs:\n    if not (knowzcode_dir / subdir).exists():\n        warnings.append(f'Missing directory: knowzcode/{subdir}')\n\n# Check .claude directory for commands/agents (plugin or local installation)\nclaude_dir = Path('.claude')\ncommands_count = 0\nskills_count = 0\nagents_count = 0\n\nif claude_dir.exists():\n    if (claude_dir / 'commands').exists():\n        commands_count = len(list((claude_dir / 'commands').glob('*.md')))\n    if (claude_dir / 'skills').exists():\n        skills_count = len(list((claude_dir / 'skills').glob('*.json')))\n    if (claude_dir / 'agents').exists():\n        agents_count = len(list((claude_dir / 'agents').glob('*.md')))\n    if (claude_dir / 'subagents').exists():\n        agents_count += len(list((claude_dir / 'subagents').glob('*.yaml')))\n\n# Also check top-level commands/skills/agents (plugin installation)\nif Path('commands').exists():\n    commands_count = max(commands_count, len(list(Path('commands').glob('*.md'))))\nif Path('skills').exists():\n    skills_count = max(skills_count, len(list(Path('skills').glob('*.json'))))\nif Path('agents').exists():\n    agents_count = max(agents_count, len(list(Path('agents').glob('*.md'))))\n\n# Expected minimums\nif commands_count < 5:\n    warnings.append(f'Expected at least 5 commands, found {commands_count}')\nif agents_count < 10:\n    warnings.append(f'Expected at least 10 agents, found {agents_count}')\n\noutputs['valid'] = len(errors) == 0\noutputs['errors'] = errors\noutputs['warnings'] = warnings\noutputs['commands_count'] = commands_count\noutputs['skills_count'] = skills_count\noutputs['agents_count'] = agents_count"
    }
  ]
}
